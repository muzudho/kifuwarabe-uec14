<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　連データベースを作ろうと思う」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　勝手にしろだぜ」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /><br />
</a>「　それはデータベースなの？」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　説明する」<br />
<br />
<br />
［１］A1<br />
［２］B２<br />
［３］C3<br />
［４］D４（B2）<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　&uarr;　実践譜を用意するのが　めんどくさいので適当だが、<br />
将棋のような棋譜を　囲碁にも導入するとする」<br />
<br />
<br />
［４］　　D４　　　（B2）<br />
ーーー　　ーーー　　ーーー<br />
１　　　　２　　　　３<br />
<br />
１．　何手目（序数）<br />
２．　着手点<br />
３．　コウ<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　&uarr;　将棋と違って　コウ　も記憶しておく必要がある」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　なんで必要なんだぜ？」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　人間の棋譜は　さかのぼって読まないから　戻し方を書いていないが、<br />
コンピューターは　さかのぼって読むから　戻し方も書いている必要がある」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /><br />
</a>「　さかのぼり方を考えるの、逆関数って言うのよ。<br />
関数に比べて　逆関数は　ふだん　そんなこと考えて生きてない人には　奇異　に映るのよ」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　勝手に映ってろだぜ」<br />
<br />
［１］A1<br />
［２］B２<br />
［３］C3<br />
［４］D４（B2）　取った石：C3<br />
　　　　　　　　　ーーーーーーーー<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　&uarr;　だから　棋譜には　取った石を記録しておく必要があるんだが&hellip;&hellip;」<br />
<br />
<br />
［２０］J10　　取った石：G９，G１０，H９，H１０<br />
　　　　　　　　　　　　ーーーーーーーーーーーーーー<br />
<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　&uarr;　大石を打ち上げたら　すごい数になるかもしらん。<br />
３６０個ぐらい石を打ち上げたらどうしよ」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　３６０個　覚えておけだぜ」<br />
<br />

<h2>リレーショナル・データベース</h2>
<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　棋譜に　取った石　３６０個も　記録したくないぜ。<br />
既存の技術に倣って、リレーショナル・データベースのやり方を導入しようぜ？」<br />
<br />
<br />
［２０］　　　［G9］　　　　&rarr;　　　G９，G１０，H９，H１０<br />
ーーーーー　　ーーーーー　　　　　ーーーーーーーーーーーーーー<br />
１　　　　　　２　　　　　　　　　３<br />
<br />
１．　何手目（序数）<br />
２．　連の石の中で一番小さな番地<br />
３．　連の石の番地のリスト<br />
<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　&uarr;　何手目と、連の石の中で一番小さな番地　を覚えておけば、<br />
どの連か　一意に指定できるはずだぜ」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　ほんとか」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　棋譜の変化は　考慮しないものとする」<br />
<br />
<br />
［２０］J10　　取った連のId：G９<br />
　　　　　　　　　　　　　　ーーーー<br />
<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　&uarr;　棋譜は　すっきりするな」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /><br />
</a>「　石を打ち上げるたびに　何番地の石を取った、と　いちいち　覚えておくの？」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　そうだぜ」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　打ち上げる石の数は　１９路盤なら　１～３６０個あるな。<br />
可変長配列に格納するか」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　Go言語は　ガベージコレクション　を使う言語らしく、<br />
その占有メモリを参照している変数が無くなれば　占有メモリは開放されると思うぜ」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　ほんとか」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /><br />
</a>「　ほんとよ。　細かい人は　ポインター変数に nil を代入してでも<br />
占有メモリを　解放の対象にするわよ」<br />
<br />

<h2>別々にする必要性</h2>
<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　棋譜と　連データベースを　別々にする必要性はあるのかだぜ？」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　のちのち、取った石の連だけではなく、<br />
全局面の　すべての連を　連データベースに　格納する予定だぜ」<br />
<br />

<h2>マッピング</h2>
<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　『２０手目のＪ２』　とか　『３０手目のＫ１０』　とか<br />
どういう構造に並べてもち、<br />
どういう探索で見つけ当てる？」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /><br />
</a>「　Go言語に　ハッシュテーブル　はあるの？」<br />
<br />
&nbsp;<a href="https://qiita.com/wifecooky/items/2ffe41d55c575b2ce5e2" title="">[Go言語] 初心者必見シリーズ: マップ（Map）</a> &nbsp;<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　&uarr;　マップという名前であるようだぜ」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　キーはどういう構造にする？」<br />
<br />
<br />
何手目　&times;　盤の面積　＋　連の石の最小の番地<br />
<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　&uarr;　上式なら　int型　に収まるだろうし、文字列よりシンプルじゃないか？」<br />
<br />
<br />
<strong>どうやって　テストするのか</strong><br />
<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　コードを書いたが、テストするの　めんどくさいな」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /><br />
</a>「　連データベースを　インポート、エクスポート　できるようにしたらいいんじゃない？」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　じゃあ　JSONフォーマットを定義するかだぜ」<br />
<br />
{<br />
&nbsp; &nbsp; "header" :<br />
&nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; &nbsp; "boardWidth" : 19,<br />
&nbsp; &nbsp; &nbsp; &nbsp; "boardHeight" : 19<br />
&nbsp; &nbsp; },<br />
&nbsp; &nbsp; "rens" :<br />
&nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; &nbsp; "{id}" :<br />
&nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "posNth" : 1,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "locate" : "A1 B2 C3 D4"<br />
&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp; &nbsp; }<br />
}<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /></a><a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><br />
</a>「　その `{id}` は手計算で求めんの？<br />
このダンプを　設定ファイルとして見たとき、めんどくさくない？」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　じゃあ　"1, A1" みたいな文字列にするかだぜ？」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　とりあえず　それで」<br />
<br />

<h2>連データベースに　連を追加してみようぜ？</h2>
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　お父ん、　連データベースは　どうやって使う？」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　初期局面は、盤面をフルスキャンしろだぜ」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /><br />
</a>「　なんか　適当な　囲碁の局面図が欲しいけど、囲碁は棋譜の権利にうるさいのよ。<br />
適当な盤面のデータを作って　読み込んでみましょう」<br />
<br />
<img src="//grayscale2.dou-jin.com/File/202209__go__18-30.png" alt="" /> <br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　&uarr;　これでいいかな？」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　適当だな」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /><br />
</a>「　その盤面をスキャンして、連データベースを　外部ファイルにエクスポートして、<br />
盤上の連を認識できているか　確かめましょう！」<br />
<br />
<img src="//grayscale2.dou-jin.com/File/202209__go__19-31.png" alt="" /> <br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　&uarr;　連じゃなくて　なんか全部の交点を出力しようとしてないかだぜ？」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　直せ！」<br />
<br />

<h2>辞書順ソート</h2>
<img src="//grayscale2.dou-jin.com/File/202209__go__19-33-1.png" alt="" /> <br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　"A1" みたいな符号で　辞書順に出力すると、<br />
読取方向が変わるぜ！」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /><br />
</a>「　"01A" にすりゃ　いいんじゃないの？」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　可読性が下がるだろ」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　外部テキストファイルは　人間が読むものと思えだぜ。<br />
可読性の低いファイルは　流行らない」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /><br />
</a>「　国際囲碁連盟に従う必要は無いんじゃないの？」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　パワフルだな」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　最小の番地を Id にするのではなくて、最大の番地を Id にしたらどうだぜ？」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　発想きたな」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /><br />
</a>「　人間は　右下から　盤を見るの？　見づらいんだけど」<br />
<br />
"1, 01A"<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /></a><br />
「　&uarr;　Id だけ 段&rarr;列　にひっくり返すというのは　どうだぜ？」<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　納得度があり、許容範囲内の答えだぜ。　それで行こ」<br />
<br />
<img src="//grayscale2.dou-jin.com/File/202209__go__19-35.png" alt="" /> <br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" /><br />
「　&uarr;　いーんじゃねーの」<br />
<br />

<h2>2手目以降は差分<br />
<br />
<img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" style="font-size: 14px;" /></h2>
「　２手目以降は、盤面全体をスキャンしなくても、<br />
石を置いてみて<br />
置く前の盤と変ったところだけ　記録すればいいと思うんだぜ」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/kifuwarabe-futsu.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748280/" alt="" /><br />
</a>「　その前にやることがあると思うぜ。<br />
どの連と　隣接しているか　を表せだぜ」<br />
<br />
<a target="_blank" href="//grayscale2.dou-jin.com/File/ohkina-hiyoko-futsu2.png" title=""><img src="//grayscale2.dou-jin.com/Img/1641748453/" alt="" /></a><br />
「　"001,01A"　という黒石の連は、　"001,01B"　という黒石の連と<br />
隣接しているのよ」<br />
<br />

<h2><img src="//grayscale2.dou-jin.com/Img/1641748205/" alt="" style="font-size: 14px;" /></h2>
「　それは　連データベースではなくて　連リンクデータベースのような<br />
別の構造で　やりたいぜ」<br />
<br />
<br />
